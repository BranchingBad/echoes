<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Braille Converter</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }
    </style>
</head>
<body class="bg-gray-100 flex items-center justify-center min-h-screen p-4 sm:p-6">
    <div class="bg-white rounded-xl shadow-2xl p-6 sm:p-8 w-full max-w-4xl border border-gray-200">
        <header class="text-center mb-6 sm:mb-8">
            <h1 class="text-3xl sm:text-4xl font-bold text-gray-800 tracking-tight">Braille Converter</h1>
            <p class="mt-2 text-gray-500 text-lg">Convert text to Braille or vice versa.</p>
        </header>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 sm:gap-8">
            <!-- Left Panel: Input and Controls -->
            <div class="space-y-6">
                <div class="relative">
                    <label for="text-input" class="block text-gray-700 font-medium mb-2" id="input-label">Enter Text</label>
                    <textarea id="text-input" rows="8" placeholder="Type or paste your text here..."
                        class="w-full p-4 border border-gray-300 rounded-lg shadow-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent transition duration-300 ease-in-out resize-none text-gray-800"></textarea>
                </div>

                <div class="flex flex-col sm:flex-row sm:items-center justify-between space-y-4 sm:space-y-0 sm:space-x-4">
                    <div class="flex-grow">
                        <label for="braille-grade" class="block text-gray-700 font-medium mb-2">Conversion Type</label>
                        <select id="conversion-type"
                            class="w-full p-3 border border-gray-300 rounded-lg shadow-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent transition duration-300 ease-in-out text-gray-700">
                            <option value="to_braille">Text to Braille</option>
                            <option value="to_text">Braille to Text</option>
                        </select>
                    </div>

                    <button id="convert-button"
                        class="w-full sm:w-auto px-6 py-3 bg-blue-600 text-white font-semibold rounded-lg shadow-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition duration-300 ease-in-out">
                        Convert
                    </button>
                </div>
            </div>

            <!-- Right Panel: Output -->
            <div class="space-y-6">
                <div class="relative">
                    <label for="braille-output" class="block text-gray-700 font-medium mb-2" id="output-label">Braille Output</label>
                    <div id="braille-output" class="braille-output-box w-full min-h-[14rem] p-4 bg-gray-50 border border-gray-300 rounded-lg shadow-inner overflow-y-auto cursor-text text-gray-800" contenteditable="true">
                        The converted Braille text will appear here.
                    </div>
                </div>

                <button id="copy-button"
                    class="w-full px-6 py-3 bg-green-600 text-white font-semibold rounded-lg shadow-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 transition duration-300 ease-in-out flex items-center justify-center">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" viewBox="0 0 20 20" fill="currentColor">
                        <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                        <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                    </svg>
                    Copy to Clipboard
                </button>
            </div>
        </div>
        
        <!-- Custom Alert Modal -->
        <div id="alert-modal" class="hidden fixed inset-0 bg-gray-900 bg-opacity-50 z-50 flex items-center justify-center p-4">
            <div class="bg-white rounded-xl shadow-lg p-6 sm:p-8 w-full max-w-sm text-center">
                <h3 id="alert-title" class="text-xl font-bold text-gray-800 mb-4"></h3>
                <p id="alert-message" class="text-gray-600 mb-6"></p>
                <button id="alert-close-button" class="w-full px-6 py-3 bg-blue-600 text-white font-semibold rounded-lg hover:bg-blue-700 focus:outline-none">OK</button>
            </div>
        </div>
    </div>

    <script>
        // Use a self-invoking async function to handle the async operations
        (async function() {
            // Mapping for Braille conversion, based on the provided Python script.
            const BRAILLE_LETTERS = {
                'a': '⠁', 'b': '⠃', 'c': '⠉', 'd': '⠙', 'e': '⠑', 'f': '⠋',
                'g': '⠛', 'h': '⠓', 'i': '⠊', 'j': '⠚', 'k': '⠅', 'l': '⠇',
                'm': '⠍', 'n': '⠝', 'o': '⠕', 'p': '⠏', 'q': '⠟', 'r': '⠗',
                's': '⠎', 't': '⠞', 'u': '⠥', 'v': '⠧', 'w': '⠺', 'x': '⠭',
                'y': '⠽', 'z': '⠵',
            };
            const PUNCTUATION_SIGNS = {
                ' ': ' ', '.': '⠲', ',': '⠂', '!': '⠖', '?': '⠦', ':': '⠒',
                ';': '⠆', '-': '⠤', '"': '⠶', '“': '⠦', '”': '⠴', "'": '⠄',
                '(': '⠐⠣', ')': '⠐⠜', '[': '⠨⠣', ']': '⠨⠜', '$': '⠐⠎', '*': '⠐⠔',
            };
            const BRAILLE_INDICATORS = {
                'CAPS': '⠠', 'CAPS_WORD': '⠠⠠', 'NUM': '⠼',
            };
            const NUMBER_MAP = {
                '1': '⠁', '2': '⠃', '3': '⠉', '4': '⠙', '5': '⠑', '6': '⠋',
                '7': '⠛', '8': '⠓', '9': '⠊', '0': '⠚',
            };
            
            // Grade 2 contractions (a simplified subset for demonstration)
            const STRONG_WORD_SIGNS = {'and': '⠯', 'for': '⠫', 'the': '⠮', 'with': '⠾'};
            const STRONG_GROUP_SIGNS = {'sh': '⠩', 'th': '⠹', 'wh': '⠱', 'ou': '⠳', 'ow': '⠪'};

            const TEXT_INPUT = document.getElementById('text-input');
            const BRAILLE_OUTPUT = document.getElementById('braille-output');
            const CONVERT_BUTTON = document.getElementById('convert-button');
            const CONVERSION_TYPE_SELECT = document.getElementById('conversion-type');
            const COPY_BUTTON = document.getElementById('copy-button');
            const ALERT_MODAL = document.getElementById('alert-modal');
            const ALERT_TITLE = document.getElementById('alert-title');
            const ALERT_MESSAGE = document.getElementById('alert-message');
            const ALERT_CLOSE_BUTTON = document.getElementById('alert-close-button');
            const INPUT_LABEL = document.getElementById('input-label');
            const OUTPUT_LABEL = document.getElementById('output-label');

            // --- Custom Alert Function (as a replacement for `alert()`) ---
            function showCustomAlert(title, message) {
                ALERT_TITLE.textContent = title;
                ALERT_MESSAGE.textContent = message;
                ALERT_MODAL.classList.remove('hidden');
            }

            ALERT_CLOSE_BUTTON.addEventListener('click', () => {
                ALERT_MODAL.classList.add('hidden');
            });

            // Reverse map for Braille to Text conversion
            const REVERSE_BRAILLE_MAP = {};
            // Populate reverse map from all existing maps
            const allMaps = [BRAILLE_LETTERS, PUNCTUATION_SIGNS, NUMBER_MAP];
            for (const map of allMaps) {
                for (const key in map) {
                    if (map.hasOwnProperty(key)) {
                        REVERSE_BRAILLE_MAP[map[key]] = key;
                    }
                }
            }

            // --- Conversion Logic ---
            function convertToBraille(text) {
                if (!text.trim()) return "";
                let braille = "";
                const words = text.match(/[A-Za-z]+|\d+|[^\w\s]|\s+/g);
                if (!words) return text;
                
                words.forEach(word => {
                    let brailleWord = "";
                    let isAllCaps = word.toUpperCase() === word && word.length > 1;
                    let isInitialCaps = word.length > 0 && word[0] === word[0].toUpperCase() && !isAllCaps;
                    
                    if (isAllCaps) {
                        brailleWord += BRAILLE_INDICATORS.CAPS_WORD;
                    } else if (isInitialCaps) {
                        brailleWord += BRAILLE_INDICATORS.CAPS;
                    }

                    let lowerCaseWord = word.toLowerCase();

                    // Priority 1: Check for numbers
                    if (!isNaN(parseInt(word)) && isFinite(word)) {
                        brailleWord += BRAILLE_INDICATORS.NUM;
                        for (let char of word) {
                            brailleWord += NUMBER_MAP[char] || '';
                        }
                    } else {
                        for (const char of lowerCaseWord) {
                            brailleWord += BRAILLE_LETTERS[char] || PUNCTUATION_SIGNS[char] || char;
                        }
                    }
                    braille += brailleWord;
                });
                return braille;
            }

            function convertToText(brailleText) {
                if (!brailleText.trim()) return "";
                let plainText = "";
                let i = 0;
                while (i < brailleText.length) {
                    const char = brailleText[i];
                    
                    if (char === BRAILLE_INDICATORS.NUM) {
                        // Handle numbers
                        i++;
                        while (i < brailleText.length && REVERSE_BRAILLE_MAP.hasOwnProperty(brailleText[i])) {
                            plainText += REVERSE_BRAILLE_MAP[brailleText[i]];
                            i++;
                        }
                    } else if (char === BRAILLE_INDICATORS.CAPS) {
                        // Handle single capital letter
                        i++;
                        if (REVERSE_BRAILLE_MAP.hasOwnProperty(brailleText[i])) {
                            plainText += REVERSE_BRAILLE_MAP[brailleText[i]].toUpperCase();
                        } else {
                            plainText += brailleText[i];
                        }
                        i++;
                    } else if (brailleText.substring(i, i + 2) === BRAILLE_INDICATORS.CAPS_WORD) {
                        // Handle all caps word
                        i += 2;
                        let word = "";
                        while (i < brailleText.length && brailleText[i] !== ' ') {
                             if (REVERSE_BRAILLE_MAP.hasOwnProperty(brailleText[i])) {
                                word += REVERSE_BRAILLE_MAP[brailleText[i]];
                            } else {
                                word += brailleText[i];
                            }
                            i++;
                        }
                        plainText += word.toUpperCase();
                    } else if (REVERSE_BRAILLE_MAP.hasOwnProperty(char)) {
                        plainText += REVERSE_BRAILLE_MAP[char];
                        i++;
                    } else {
                        plainText += char;
                        i++;
                    }
                }
                return plainText;
            }

            // --- UI and Event Listeners ---
            CONVERT_BUTTON.addEventListener('click', () => {
                const inputText = TEXT_INPUT.value;
                const conversionType = CONVERSION_TYPE_SELECT.value;
                let convertedText;

                if (conversionType === "to_braille") {
                    convertedText = convertToBraille(inputText);
                } else if (conversionType === "to_text") {
                    convertedText = convertToText(inputText);
                }

                BRAILLE_OUTPUT.textContent = convertedText;
            });
            
            CONVERSION_TYPE_SELECT.addEventListener('change', () => {
                const type = CONVERSION_TYPE_SELECT.value;
                if (type === "to_braille") {
                    INPUT_LABEL.textContent = "Enter Text";
                    OUTPUT_LABEL.textContent = "Braille Output";
                    TEXT_INPUT.placeholder = "Type or paste your text here...";
                    BRAILLE_OUTPUT.textContent = "The converted Braille text will appear here.";
                    BRAILLE_OUTPUT.classList.remove('braille-text');
                } else {
                    INPUT_LABEL.textContent = "Enter Braille";
                    OUTPUT_LABEL.textContent = "Text Output";
                    TEXT_INPUT.placeholder = "Paste your Braille Grade 1 text here...";
                    BRAILLE_OUTPUT.textContent = "The converted plain text will appear here.";
                    BRAILLE_OUTPUT.classList.add('braille-text');
                }
                TEXT_INPUT.value = "";
            });

            COPY_BUTTON.addEventListener('click', () => {
                const textToCopy = BRAILLE_OUTPUT.textContent;
                if (textToCopy.trim() === "" || textToCopy.trim() === "The converted Braille text will appear here." || textToCopy.trim() === "The converted plain text will appear here.") {
                    showCustomAlert("Nothing to Copy", "The output box is empty.");
                    return;
                }
                
                // Use document.execCommand for better cross-browser support
                const tempTextArea = document.createElement("textarea");
                tempTextArea.value = textToCopy;
                document.body.appendChild(tempTextArea);
                tempTextArea.select();
                try {
                    document.execCommand('copy');
                    showCustomAlert("Success!", "Text has been copied to your clipboard.");
                } catch (err) {
                    showCustomAlert("Copy Failed", "Failed to copy text. Please try again.");
                } finally {
                    document.body.removeChild(tempTextArea);
                }
            });
        })();
    </script>
</body>
</html>
